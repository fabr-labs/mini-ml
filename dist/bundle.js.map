{"version":3,"file":"bundle.js","sources":["../src/microscope.js","../src/functions/createTemplate.js"],"sourcesContent":["import { createTemplate } from './functions/createTemplate.js';\n\nexport function microScope({ state: init }) {\n  const funcs = [];\n\n  const handler = {\n    set(target, property, value) {\n      target[property] = value;\n      funcs.forEach(func => func(target));\n      return true;\n    }\n  };\n\n  const proxy = new Proxy(init, handler);\n\n  return (strings, ...directives) => {\n    const template = createTemplate(strings.reduce((acc, value, i) => {\n      return i === strings.length - 1 ? `${acc}${value}` : directives[i].text ? `${acc}${value}<template data-ms=\"${i}\"></template>` : `${acc}${value} data-ms=\"${i}\"`;\n    }, ``));\n\n    document.body.appendChild(template);\n\n    directives.forEach((directive, i) => {\n      for (const [key, select] of Object.entries(directive)) {\n        const elem = template.querySelector(`[data-ms=\"${i}\"]`);\n        switch (key) {\n          case 'text':\n            const { parentNode } = elem;\n            funcs.push(() => parentNode.innerText = select(proxy));\n            break;\n\n          case 'class':\n            funcs.push(() => {\n              for (const [klass, add] of Object.entries(select(proxy))) {\n                elem.classList[add ? 'add' : 'remove' ](klass)\n              }\n            });\n            break;\n\n          case 'if':\n            funcs.push(() => elem.style.display = select(proxy) ? '' : 'none');\n            break;\n        \n          default:\n            elem.addEventListener(key, (event) => select(event, proxy));\n            break;\n        }\n      }\n    });\n    proxy._ready = true;\n  }\n}\n","export function createTemplate(html) {\n  const container = document.createElement('div');\n  container.innerHTML = html; \n  return container.firstElementChild;\n}"],"names":["state","init","funcs","proxy","Proxy","set","target","property","value","forEach","func","strings","directives","template","html","container","document","createElement","innerHTML","firstElementChild","createTemplate","reduce","acc","i","length","text","body","appendChild","directive","key","select","Object","entries","elem","querySelector","parentNode","push","innerText","klass","add","classList","style","display","addEventListener","event","_ready"],"mappings":"uFAEO,UAAsBA,MAAOC,IAClC,MAAMC,EAAQ,GAURC,EAAQ,IAAIC,MAAMH,EARR,CACdI,IAAG,CAACC,EAAQC,EAAUC,KACpBF,EAAOC,GAAYC,EACnBN,EAAMO,QAAQC,GAAQA,EAAKJ,KACpB,KAMX,MAAO,CAACK,KAAYC,KAClB,MAAMC,EChBH,SAAwBC,GAC7B,MAAMC,EAAYC,SAASC,cAAc,OAEzC,OADAF,EAAUG,UAAYJ,EACfC,EAAUI,kBDaEC,CAAeT,EAAQU,OAAO,CAACC,EAAKd,EAAOe,IACnDA,IAAMZ,EAAQa,OAAS,EAAI,GAAGF,IAAMd,IAAUI,EAAWW,GAAGE,KAAO,GAAGH,IAAMd,uBAA2Be,iBAAmB,GAAGD,IAAMd,cAAkBe,KAC3J,KAEHP,SAASU,KAAKC,YAAYd,GAE1BD,EAAWH,QAAQ,CAACmB,EAAWL,KAC7B,IAAK,MAAOM,EAAKC,KAAWC,OAAOC,QAAQJ,GAAY,CACrD,MAAMK,EAAOpB,EAASqB,cAAc,aAAaX,OACjD,OAAQM,GACN,IAAK,OACH,MAAMM,WAAEA,GAAeF,EACvB/B,EAAMkC,KAAK,IAAMD,EAAWE,UAAYP,EAAO3B,IAC/C,MAEF,IAAK,QACHD,EAAMkC,KAAK,KACT,IAAK,MAAOE,EAAOC,KAAQR,OAAOC,QAAQF,EAAO3B,IAC/C8B,EAAKO,UAAUD,EAAM,MAAQ,UAAWD,KAG5C,MAEF,IAAK,KACHpC,EAAMkC,KAAK,IAAMH,EAAKQ,MAAMC,QAAUZ,EAAO3B,GAAS,GAAK,QAC3D,MAEF,QACE8B,EAAKU,iBAAiBd,EAAMe,GAAUd,EAAOc,EAAOzC,QAK5DA,EAAM0C,QAAS"}